package org.example.poi.test;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.List;

import org.apache.poi.ooxml.POIXMLProperties;
import org.apache.poi.xwpf.extractor.XWPFWordExtractor;
import org.apache.poi.xwpf.usermodel.XWPFDocument;
import org.apache.poi.xwpf.usermodel.XWPFParagraph;
import org.apache.poi.xwpf.usermodel.XWPFRun;


public class POITest {
    public static void main(String[] args) throws IOException {
        String getReportMenuData = "{\"name\":\"\",\"version\":2,\"type\":\"vertical-body\",\"properties\":{\"createTime\":\"\",\"company\":\"\",\"author\":\"\"},\"pageSetting\":{\"orientation\":\"vertical\",\"pageMarginLeft\":1.5,\"pageMarginRight\":1.5,\"pageMarginTop\":1.5,\"pageMarginBottom\":1.5,\"paperType\":\"A4\",\"paperWidth\":21,\"paperHeight\":29.7,\"isUnlimitedPaperSize\":true},\"watermark\":{\"enable\":true,\"text\":\"\",\"color\":\"#999999\",\"transparency\":50,\"fontFamily\":\"Microsoft YaHei\",\"angle\":45,\"fontSize\":\"24pt\"},\"option\":{\"bodyTopLine\":{\"width\":2,\"color\":\"black\"},\"bodyLeftLine\":{\"width\":2,\"color\":\"black\"},\"bodyReightLine\":{\"width\":2,\"color\":\"black\"},\"bodyBottomLine\":{\"width\":2,\"color\":\"black\"},\"fillWithBlankRow\":false,\"noOverPageDisplay\":true},\"header\":{\"visible\":false,\"rows\":[{\"_height\":23}],\"columns\":[{\"width\":227,\"autoHide\":false},{\"width\":227,\"autoHide\":false},{\"width\":372,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":2,\"data\":\"\",\"autoMergeSameContent\":false}]},\"title\":{\"visible\":true,\"rows\":[{\"_height\":68}],\"columns\":[{\"width\":227,\"autoHide\":false},{\"width\":227,\"autoHide\":false},{\"width\":372,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"center\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"20pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":3},\"data\":\"'清标结果汇总表'\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":0,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false}]},\"tableHeader\":{\"visible\":true,\"rows\":[{\"_height\":23},{\"_height\":23},{\"_height\":23},{\"_height\":23},{\"_height\":23}],\"columns\":[{\"width\":227,\"autoHide\":false},{\"width\":227,\"autoHide\":false},{\"width\":372,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":2},\"data\":\"'标段名称：'+{bidsegName}\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":0,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"right\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":\"'第  ' + {页数} + '  页'+'  '+'共  ' + {总页数} + '  页'\",\"autoMergeSameContent\":false},{\"row\":1,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":3},\"data\":\"'投标单位家数：'+{tendererCount}\",\"autoMergeSameContent\":false},{\"row\":1,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":1,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"right\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":2,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":3},\"data\":\"'创建时间：'+{createTime}\",\"autoMergeSameContent\":false},{\"row\":2,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":2,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"right\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":3,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":3},\"data\":\"'检查结果：共涉及'+{totalCheckCount}+'项检查，异常投标文件'+{exceptionFiles}+'个，异常数量'+{exceptionCount}+'个。'\",\"autoMergeSameContent\":false},{\"row\":3,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":3,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"right\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":4,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"merge\":{\"rowspan\":1,\"colspan\":3},\"data\":\"'不平衡报价分析规则：基准价：'+{baseAmoutTypeDesc}+'；偏差范围：【过高】差额率≥'+{highValue}+'%，【过低】差额率≤'+{lowValue}+'%；'\",\"autoMergeSameContent\":false},{\"row\":4,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false},{\"row\":4,\"col\":2,\"style\":{\"color\":\"#000\",\"background\":\"#CCCCCC\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"right\",\"verticalAlign\":\"top\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"data\":null,\"autoMergeSameContent\":false}]},\"body\":{\"details\":{\"dataSourceName\":\"\",\"title\":{\"visible\":false,\"rows\":[],\"columns\":[],\"cells\":[]},\"dataArea\":{\"visible\":true,\"rows\":[],\"columns\":[],\"cells\":[]},\"footer\":{\"visible\":false,\"rows\":[],\"columns\":[],\"cells\":[]},\"pageStat\":{\"visible\":false,\"rows\":[],\"columns\":[],\"cells\":[]},\"total\":{\"visible\":false,\"rows\":[],\"columns\":[],\"cells\":[]},\"_options\":[],\"_children\":[{\"dataSourceName\":\"清标结果汇总\",\"title\":{\"visible\":true,\"rows\":[{\"_height\":28}],\"columns\":[{\"width\":164,\"autoHide\":false},{\"width\":660,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"style\":{\"color\":\"#000000\",\"background\":\"#EAEAEA\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"center\",\"verticalAlign\":\"middle\",\"fontWeight\":\"bold\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"border\":{\"left\":{\"width\":1,\"color\":\"#000\"},\"right\":{\"width\":1,\"color\":\"#000\"},\"top\":{\"width\":1,\"color\":\"#000\"},\"bottom\":{\"width\":1,\"color\":\"#000\"}},\"data\":\"'检查项'\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"style\":{\"color\":\"#000000\",\"background\":\"#EAEAEA\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"center\",\"verticalAlign\":\"middle\",\"fontWeight\":\"bold\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"border\":{\"left\":{\"width\":1,\"color\":\"#000\"},\"right\":{\"width\":1,\"color\":\"#000\"},\"top\":{\"width\":1,\"color\":\"#000\"},\"bottom\":{\"width\":1,\"color\":\"#000\"}},\"data\":\"<xmhfDetail,label>\",\"autoMergeSameContent\":false}]},\"dataArea\":{\"visible\":true,\"rows\":[{\"_height\":25}],\"columns\":[{\"width\":164,\"autoHide\":false},{\"width\":660,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"left\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"border\":{\"left\":{\"width\":1,\"color\":\"#000\"},\"right\":{\"width\":1,\"color\":\"#000\"},\"top\":{\"width\":1,\"color\":\"#000\"},\"bottom\":{\"width\":1,\"color\":\"#000\"}},\"data\":\"[checkItem]\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"style\":{\"color\":\"#000\",\"background\":\"#FFFFFF\",\"fontFamily\":\"Microsoft YaHei\",\"textAlign\":\"center\",\"verticalAlign\":\"middle\",\"fontWeight\":\"normal\",\"fontStyle\":\"normal\",\"fontSize\":\"9pt\",\"textDecoration\":\"none\"},\"border\":{\"left\":{\"width\":1,\"color\":\"#000\"},\"right\":{\"width\":1,\"color\":\"#000\"},\"top\":{\"width\":1,\"color\":\"#000\"},\"bottom\":{\"width\":1,\"color\":\"#000\"}},\"data\":\"[xmhfDetail,value]\",\"autoMergeSameContent\":false}]},\"footer\":{\"visible\":false,\"rows\":[{\"_height\":23}],\"columns\":[{\"width\":164,\"autoHide\":false},{\"width\":660,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"data\":\"\",\"autoMergeSameContent\":false}]},\"pageStat\":{\"visible\":false,\"rows\":[{\"_height\":23}],\"columns\":[{\"width\":164,\"autoHide\":false},{\"width\":660,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"data\":\"\",\"autoMergeSameContent\":false}]},\"total\":{\"visible\":false,\"rows\":[{\"_height\":23}],\"columns\":[{\"width\":164,\"autoHide\":false},{\"width\":660,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"data\":\"\",\"autoMergeSameContent\":false}]},\"_options\":[],\"_children\":[],\"settings\":{\"newPagePerRecord\":false}}],\"settings\":{\"newPagePerRecord\":false}}},\"footer\":{\"visible\":true,\"rows\":[{\"_height\":23}],\"columns\":[{\"width\":227,\"autoHide\":false},{\"width\":227,\"autoHide\":false},{\"width\":371,\"autoHide\":false}],\"cells\":[{\"row\":0,\"col\":0,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":1,\"data\":\"\",\"autoMergeSameContent\":false},{\"row\":0,\"col\":2,\"data\":\"\",\"autoMergeSameContent\":false}]},\"macros\":[]}";
        System.out.println(getReportMenuData);

        String docFilePath = "WorkResearch/src/main/resources/清标报告.docx";
        FileInputStream fis = null;

        try {
            // 打开Word文件
            fis = new FileInputStream(docFilePath);
            XWPFDocument doc = new XWPFDocument(fis);
            XWPFWordExtractor extractor = new XWPFWordExtractor(doc);
            // 打印doc文本内容
            String text = extractor.getText();
//            System.out.println(text);

            // 打印doc文本内容的同时获取文本的格式
            List<XWPFParagraph> paragraphs = doc.getParagraphs();
            for (XWPFParagraph paragraph : paragraphs){
                // 打印文本内容，不包含表格中的内容
//                System.out.println(paragraph.getText());
                List<XWPFRun> runs = paragraph.getRuns();
                for (XWPFRun run : runs) {
                    // 打印对应文字内容
                    System.out.println(run.getText(0));
//                    // 打印对应字体
                    System.out.println(run.getFontName());
//                    // 打印对应字号
//                    System.out.println(run.getFontSize());
//                    // 打印是否加粗
//                    System.out.println(run.isBold());
//                    // 打印对齐情况
//                    System.out.println(run.getTextPosition());
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            fis.close();
        }
    }
}